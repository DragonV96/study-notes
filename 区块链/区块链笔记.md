# 区块链笔记

## 1 区块链

### 1.1 基本概念

**1. 概念**

区块链是一个提供了拜占庭容错、并保证了最终一致性的分布式数据库；从数据结构上看，它是基于时间序列的链式数据块结构；从节点拓扑上看，它所有的节点互为冗余备份；从操作上看，它提供了基于密码学的公私钥管理体系来管理账户。

**2. 作用**

- 区块链可以帮助多个节点达成共识去记录和 Token 相关的事情；
- 区块链可以帮助所有人无门槛地构建属于自己的小经济系统。

**3. 特征**

区块链的7大特质：

- 区块链的存储基于分布式数据库；
- 数据库是区块链的数据载体，区块链是交易的业务逻辑载体；
- 区块链按时间序列化区块数据，整个网络有一个最终确定状态；
- 区块链只对添加有效，对其他操作无效；
- 交易基于非对称加密的公私钥验证；
- 区块链网络要求拜占庭将军容错；
- 共识算法能够“解决”双花问题。

**4. 分类**

- 公链：公开的区块链。
- 联盟链（许可链）：这个区块链具有准入许可，不像公链，任何人都可以随时进入（准入许可也就意味着候选节点进入区块链时需要得到已经在网络中的节点许可）。
- 侧链：侧链是一种双向挂钩技术，将主链中的代币锁定到侧链中使用。

**5. 技术组成**

区块链至少需要4个模块：

- P2P 网络协议
- 分布式一致性算法（共识机制）
- 加密签名算法
- 账户与存储模型

#### 1.1.1 P2P 网络协议

P2P 网络协议是所有区块链的最底层模块，负责交易数据的网络传输和广播、节点发现和维护。

> P2P 交互协议具有自己的指令集合，指令体现在在消息头（Message Header) 的命令（command）域中，这些命令为上层提供了节点发现、节点获取、区块头获取、区块获取等功能（具体见比特币开发者指南中的 Peer Discovery 的章节）。

2）分布式一致性算法



### 1.2 区块链常识

**区块链基本流程**

- 公开记账：记载每一笔 Transaction，即记载每一笔交易的付款人、收款人和付款金额。
- 创建创世区块
- 交易（Transaction）
- 打包 Transaction（挖矿）
- 广播交易：将打包好的 Transaction 广播到所有区块上

**常见单词**

- KYC（Know Your Customer）：交易所充分了解你的客户，对账户持有人的强化审查。

### 1.3 共识机制

#### 1.3.1 基础信息

**1. 概念**

共识机制是区块链是核心技术之一。

**2. 作用**

它决定了区块链的：

- 业务吞吐量
- 交易速度
- 不可篡改性
- 准入门槛

**3. 目的**

共识机制主要解决了两个问题：

- 谁有权力（如记账）
- 作弊问题

#### 1.3.2 PoW 工作量证明

**1. 概念**

PoW （Proof of Work）工作量证明，它有两个概念：

- 计算资源（算力）是决定记账权力的唯一因素；
- 计算难度（挖矿难度），计算难度是区块链为了控制产生答案的速度。

**2. 规则**

所有记账节点都会遵循以下两条规则：

- 规则一：一个代币如果已经被花费，那么会被标记成已花费，如果再次接收到这个代币被花费的请求，那么记账节点会拒绝打包这笔交易；
- 规则二：如果同时接收到两个已打包区块，这两个已打包区块中装的两笔交易出现了一个代币被花费了两次的情况，这种情况也就是我们所说的分叉（Fork），那么选择挖矿难度比较大的那个已打包区块。

> 规则一避免了未确认交易的双花攻击，规则二基本避免已经确认的交易中（已打包区块中）的双花问题。

#### 1.3.3 

### 1.4 区块链问题

#### 1.4.1 拜占庭将军问题

**1. 隐含该问题的共识机制**

- PoW（工作量证明）
- 

**2. 概念**

拜占庭将军问题可以简单分为两个问题：

- 节点精分：即 A 节点广播到 D 节点的信息为投票给 B 节点，但广播到 D 节点的信息为投票给  B 节点；
- 中继结点作弊：即中继节点篡改上一个节点的投票消息。

（更完整具体的内容未完待续）

**3. 解决方案**

#### 1.4.2 双花攻击

**1. 概念**

双花攻击（double-spending），指一个代币被花费了两次。

### 1.5 区块链应用

- 数字货币
- 数字资产
- ICO（Initial Coin Offering）：首次代币发行，即区块链众筹
- 游戏虚拟资产
- 数据公正公示

#### 数字货币

**1. 概念**

数字货币是区块链的第一大应用类型，市场上目前可统计的数字货币币种有 1500 种以上。

**2. 特点**

- 总量透明公开
- 数字货币缓慢释放
- 代码执行规则

1）总量透明公开

数字货币的发行是在项目创建之初，是白皮书事先就规定好了的，白皮书通常是一个区块链项目公开发布的一种阐述性文档，其中简述了项目的宗旨和愿景以及设计蓝图。在白皮书中，这个项目总共发行多少数字货币，投资者、用户、矿工能够获得多少也都是事先分配好的。数字货币的总量也分为两种，一种是总量设上限的，另外一种是不设上限的。

2）数字货币缓慢释放

数字货币在分配好不同角色的额度之后，往往不是一下子就能发行完毕的，通常在矿工的那部分是需要靠“挖”才能出来的，这也就是前面我们所说的挖矿，挖矿为数字货币的缓慢释放提供了一种方法。

3）代码执行规则

由于我们在白皮书中规定好了总量和数字货币释放的机制，白皮书的内容会成为整个社区的基础共识，所以在项目的主网上线之后，数字货币的释放不再是人为控制，而是在代码层面体现，代码将负责控制数字货币的释放，这里去除了人为操作的因素。

### 1.6 工具

#### 1.6.1 行情

行情网站及 APP：

- coinmarketcap
- feixiaohao
- MyToken
- 币看

#### 1.6.2 钱包

钱包从技术角度分为三类：

- 全节点钱包：全节点钱包是指官方发行的一种数字货币钱包版本，这个版本包含了完整的功能需求，挖矿、发送交易、查询交易记录、管理私钥。
- SPV 轻钱包（Simplified Payment Verification）：轻钱包为了用户体验，牺牲了全节点的部分功能，属于全节点钱包的简化版，如挖矿功能、查询交易功能就没有。
- 中心化资产托管钱包：第三方服务商帮助你打理你的数字货币，找一个中介托管你的数字货币。（如 imToken、TokenPocket、 blockchain.info 等）





